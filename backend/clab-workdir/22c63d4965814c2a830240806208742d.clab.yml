name: ae3gis-network
topology:
  nodes:
    if-router-1:
      kind: linux
      image: alpine:latest
      exec:
      - ip addr add 10.0.1.1/24 dev eth1
      - sysctl -w net.ipv4.ip_forward=1
    if-fw-1:
      kind: linux
      image: alpine:latest
      exec:
      - ip addr add 10.0.1.2/24 dev eth1
      - sysctl -w net.ipv4.ip_forward=1
    if-sw-1:
      kind: linux
      image: alpine:latest
      exec:
      - ip link add br0 type bridge
      - ip link set eth1 master br0
      - ip link set eth2 master br0
      - ip link set eth3 master br0
      - ip link set eth4 master br0
      - ip link set eth5 master br0
      - ip link set br0 up
      - ip addr add 10.0.1.3/24 dev br0
    if-web-1:
      kind: linux
      image: alpine:latest
      exec:
      - ip addr add 10.0.1.10/24 dev eth1
    if-ws-1:
      kind: linux
      image: alpine:latest
      exec:
      - ip addr add 10.0.1.100/24 dev eth1
    if-ws-2:
      kind: linux
      image: alpine:latest
      exec:
      - ip addr add 10.0.1.101/24 dev eth1
    if-ws-3:
      kind: linux
      image: alpine:latest
      exec:
      - ip addr add 10.0.1.102/24 dev eth1
    if-ot-sw:
      kind: linux
      image: alpine:latest
      exec:
      - ip link add br0 type bridge
      - ip link set eth1 master br0
      - ip link set eth2 master br0
      - ip link set eth3 master br0
      - ip link set eth4 master br0
      - ip link set eth5 master br0
      - ip link set br0 up
      - ip addr add 10.0.2.1/24 dev br0
    if-plc-1:
      kind: linux
      image: alpine:latest
      exec:
      - ip addr add 10.0.2.10/24 dev eth1
    if-plc-2:
      kind: linux
      image: alpine:latest
      exec:
      - ip addr add 10.0.2.11/24 dev eth1
    if-plc-3:
      kind: linux
      image: alpine:latest
      exec:
      - ip addr add 10.0.2.12/24 dev eth1
    if-ot-ws:
      kind: linux
      image: alpine:latest
      exec:
      - ip addr add 10.0.2.100/24 dev eth1
    if-dmz-fw:
      kind: linux
      image: alpine:latest
      exec:
      - ip addr add 10.0.3.1/24 dev eth1
      - sysctl -w net.ipv4.ip_forward=1
    if-dmz-web:
      kind: linux
      image: alpine:latest
      exec:
      - ip addr add 10.0.3.10/24 dev eth1
    if-dmz-file:
      kind: linux
      image: alpine:latest
      exec:
      - ip addr add 10.0.3.11/24 dev eth1
  links:
  - endpoints:
    - if-router-1:eth1
    - if-fw-1:eth1
  - endpoints:
    - if-fw-1:eth2
    - if-sw-1:eth1
  - endpoints:
    - if-sw-1:eth2
    - if-web-1:eth1
  - endpoints:
    - if-sw-1:eth3
    - if-ws-1:eth1
  - endpoints:
    - if-sw-1:eth4
    - if-ws-2:eth1
  - endpoints:
    - if-sw-1:eth5
    - if-ws-3:eth1
  - endpoints:
    - if-ot-sw:eth1
    - if-plc-1:eth1
  - endpoints:
    - if-ot-sw:eth2
    - if-plc-2:eth1
  - endpoints:
    - if-ot-sw:eth3
    - if-plc-3:eth1
  - endpoints:
    - if-ot-sw:eth4
    - if-ot-ws:eth1
  - endpoints:
    - if-dmz-fw:eth1
    - if-dmz-web:eth1
  - endpoints:
    - if-dmz-fw:eth2
    - if-dmz-file:eth1
  - endpoints:
    - if-router-1:eth2
    - if-dmz-fw:eth3
  - endpoints:
    - if-router-1:eth3
    - if-ot-sw:eth5
