name: test-simple-topology
topology:
  nodes:
    router1:
      kind: linux
      image: frrouting/frr:latest
      exec:
        - sysctl -w net.ipv4.ip_forward=1
        - ip addr add 10.0.1.1/24 dev eth1
    switch1:
      kind: linux
      image: alpine:latest
      exec:
        - ip link add br0 type bridge
        - ip link set br0 up
        - ip link set eth1 master br0
        - ip link set eth2 master br0
        - ip link set eth3 master br0
        - ip addr add 10.0.1.2/24 dev br0
        - ip route replace default via 10.0.1.1
    workstation1:
      kind: linux
      image: alpine:latest
      exec:
        - ip addr add 10.0.1.3/24 dev eth1
        - ip route replace default via 10.0.1.1
    workstation2:
      kind: linux
      image: alpine:latest
      exec:
        - ip addr add 10.0.1.4/24 dev eth1
        - ip route replace default via 10.0.1.1
  links:
    - endpoints: ["switch1:eth1", "router1:eth1"]
    - endpoints: ["switch1:eth2", "workstation1:eth1"]
    - endpoints: ["switch1:eth3", "workstation2:eth1"]
